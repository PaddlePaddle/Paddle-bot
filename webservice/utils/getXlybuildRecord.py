import requests
import json
from analyze_buildLog_bak import getBasicCIIndex, getDetailsCIIndex
from check import xlyJob
from db import Database
from readConfig import ReadConfig

localConfig = ReadConfig()

startTime = 1615132800 #1.25 00:00
endTime = 1615737600 # 2.1 00:00
#'PR-CI-Coverage':6512,
#'PR-CI-Py3':5870,
develop_ci_dict = {
        'PR-CI-Inference':5564, 'PR-CI-CPU-Py2':8913, 
        'PR-CI-APPROVAL':11587, 
        'PR-CI-Mac': 9929, 'PR-CI-Mac-Python3': 10496, 
        'PR-CI-Windows': 10090, 'PR-CI-Windows-OPENBLAS':10085
        }
release_ci_dict = {
        'PR-CI-Coverage-20':7777,'PR-CI-Py3-20':7779,
        'PR-CI-Inference-20':7778, 'PR-CI-CPU-Py2-20':9701, 
        'PR-CI-APPROVAL-20':12196,
        'PR-CI-Mac-20':12148, 'PR-CI-Mac-Python3-20':12149,
        'PR-CI-Windows-20':12150, 'PR-CI-Windows-OPENBLAS-20':12151
    }

xlytask = xlyJob()
db = Database()
'''
url = "https://xly.bce.baidu.com/paddlepaddle/paddle/ipipe/rest/v3/pipeline-builds?_embed[]=trigger&_embed[]=stageBuilds&_include[]=ext.indexOfStageWithCompileBuild&_include[]=stageBuilds.ext.releaseVersion&_limit=600&_offset=0&branch=develop&pipelineConfId={}"
basic_supplements = []
details_supplements = []
develop_ci_dict = {'PR-CI-Windows': 10090}
cancel_job = []
for key in develop_ci_dict:
    print(key)
    confid = develop_ci_dict[key]
    url = url.format(confid)
    resxly = requests.get(url).json()
    print(len(resxly))
    for i in range(len(resxly)):
        print('NUM: %s' %i)
        task = resxly[i]
        if int(str(task['startTime'])[:-3]) > startTime and int(str(task['startTime'])[:-3]) < endTime:
            targetid = task['id']
            jobid = task['headJob']
            sha = task['commitId']
            triggerUser = task['stageBuilds'][0]['triggerUser']
            target_url = 'https://xly.bce.baidu.com/paddlepaddle/paddle/newipipe/detail/%s/job/%s' %(targetid, jobid)
            ifCancel = xlytask.CancelJobByXly(target_url)
            print("ifCancel %s : %s" %(target_url, ifCancel))
            if ifCancel == False: #CI被取消的不写入数据库
                document_fix = False
                basic_ci_index_dict = getBasicCIIndex('PaddlePaddle/Paddle', sha, document_fix, target_url)
                if len(basic_ci_index_dict) != 0:
                    basic_ci_index_dict['ciName'] = key
                    basic_ci_index_dict['commitId'] = sha
                    basic_ci_index_dict['status'] = 'success' if task['status'] == "SUCC" else 'failure'
                    basic_ci_index_dict['repo'] = 'PaddlePaddle/Paddle'
                    basic_ci_index_dict['triggerUser'] = triggerUser
                    query_stat = "SELECT * FROM paddle_ci_status WHERE ciName='%s' and commitId='%s' and status='%s' and commit_createTime=%s" %(basic_ci_index_dict['ciName'], basic_ci_index_dict['commitId'], basic_ci_index_dict['status'], basic_ci_index_dict['commit_createTime'])
                    result = list(db.query(query_stat))
                    if len(result) == 0:
                        basic_supplements.append(basic_ci_index_dict) #但是少一个document_fix指标
                    if basic_ci_index_dict['EXCODE'] not in [2, 7]: #build error Not in paddle_ci_index
                        query_stat = "SELECT * FROM paddle_ci_index WHERE ciName='%s' and commitId='%s' and EXCODE=%s and createTime=%s" %(basic_ci_index_dict['ciName'], basic_ci_index_dict['commitId'], basic_ci_index_dict['EXCODE'], basic_ci_index_dict['commit_createTime'])
                        res = list(db.query(query_stat))
                        if len(res) == 0:
                            detailed_ci_index_dict = getDetailsCIIndex(basic_ci_index_dict, target_url)
                            details_supplements.append(detailed_ci_index_dict)
            else:
                cancel_job.append(target_url)
            print("basic_supplements")
            print(basic_supplements)
            print("details_supplements")
            print(details_supplements)
    print("cancel_job")
    print(cancel_job)
    

'''
basic_supplements = [{'branch': 'develop', 'PR': '31613', 'commit_createTime': 1615724695, 'paddle_build_startTime': 1615724700, 'paddle_build_endTime': 1615727328, 'waitTime_total': 5, 'execTime_total': 2628, 'EXCODE': 7, 'ciName': 'PR-CI-Windows', 'commitId': 'd4d406f79e88785c16420395f1c4115ee7126904', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'niuliling123'}, {'branch': 'develop', 'PR': '31362', 'commit_createTime': 1615645238, 'paddle_build_startTime': 1615645242, 'paddle_build_endTime': 1615645263, 'waitTime_total': 4, 'execTime_total': 21, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': '02346930408c15037823c6eb3dc74bb4de8a0fed', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'gongweibao'}, {'branch': 'develop', 'PR': '30834', 'commit_createTime': 1615555651, 'paddle_build_startTime': 1615555656, 'paddle_build_endTime': 1615555677, 'waitTime_total': 5, 'execTime_total': 21, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': 'db61d6b09378fe9bfcf060dba89fd96951d8052d', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'JamesLim-sy'}, {'branch': 'develop', 'PR': '31093', 'commit_createTime': 1615552982, 'paddle_build_startTime': 1615552988, 'paddle_build_endTime': 1615559635, 'waitTime_total': 6, 'execTime_total': 6647, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '99ce420f7a772214444df35f38c8790a1aa7045a', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'arlesniak'}, {'branch': 'develop', 'PR': '31551', 'commit_createTime': 1615552795, 'paddle_build_startTime': 1615552802, 'paddle_build_endTime': 1615559848, 'waitTime_total': 7, 'execTime_total': 7046, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '96ebd01b02d19d419787c2e5878965c95e23ae38', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'qili93'}, {'branch': 'develop', 'PR': '31551', 'commit_createTime': 1615552508, 'paddle_build_startTime': 1615552514, 'paddle_build_endTime': 1615552691, 'waitTime_total': 6, 'execTime_total': 177, 'EXCODE': 7, 'ciName': 'PR-CI-Windows', 'commitId': '59f287fdf196181259a0353e2017701b2d9bdb72', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'qili93'}, {'branch': 'develop', 'PR': '31602', 'commit_createTime': 1615552054, 'paddle_build_startTime': 1615552058, 'paddle_build_endTime': 1615557657, 'waitTime_total': 4, 'execTime_total': 5599, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '2da4be5d01cf2b98fcff8524234d9145c4ff56e7', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'chenwhql'}, {'branch': 'develop', 'PR': '31511', 'commit_createTime': 1615549520, 'paddle_build_startTime': 1615549526, 'paddle_build_endTime': 1615555648, 'waitTime_total': 6, 'execTime_total': 6122, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': 'e2defa2af790bf520465b0d1a79fb1ab7f9e208b', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'jiweibo'}, {'branch': 'develop', 'PR': '31226', 'commit_createTime': 1615548422, 'paddle_build_startTime': 1615548426, 'paddle_build_endTime': 1615548540, 'waitTime_total': 4, 'execTime_total': 114, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': 'c588c9606d462a8105eff090648d6cb9c37d4dc9', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'seemingwang'}, {'branch': 'develop', 'PR': '31505', 'commit_createTime': 1615548097, 'paddle_build_startTime': 1615548101, 'paddle_build_endTime': 1615554520, 'waitTime_total': 4, 'execTime_total': 6419, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '3746d7e9bac375c69e1e2fce26be893c2cb8dde6', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'XieYunshen'}, {'branch': 'develop', 'PR': '31498', 'commit_createTime': 1615547574, 'paddle_build_startTime': 1615547578, 'paddle_build_endTime': 1615551458, 'waitTime_total': 4, 'execTime_total': 3880, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': 'f9d997b5f2919a545b9892d5015061003936ca48', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'XieYunshen'}, {'branch': 'develop', 'PR': '31570', 'commit_createTime': 1615543522, 'paddle_build_startTime': 1615543526, 'paddle_build_endTime': 1615550664, 'waitTime_total': 4, 'execTime_total': 7138, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '483b7d30649ec1cc3ba3c3c36373786e236d85a3', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'gongweibao'}, {'branch': 'develop', 'PR': '31593', 'commit_createTime': 1615542116, 'paddle_build_startTime': 1615542253, 'paddle_build_endTime': 1615548487, 'waitTime_total': 137, 'execTime_total': 6234, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '3f01c5cb81cf8bb99c1f3cd6270060fe248a316c', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'JZ-LIANG'}, {'branch': 'develop', 'PR': '31254', 'commit_createTime': 1615541125, 'paddle_build_startTime': 1615541602, 'paddle_build_endTime': 1615541642, 'waitTime_total': 477, 'execTime_total': 40, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': 'f07436a21bb5e9825b58e23a9bc1179bf951bbe7', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'a6802739'}, {'branch': 'develop', 'PR': '31594', 'commit_createTime': 1615540859, 'paddle_build_startTime': 1615540862, 'paddle_build_endTime': 1615541055, 'waitTime_total': 3, 'execTime_total': 193, 'EXCODE': 1, 'ciName': 'PR-CI-Windows', 'commitId': '8c279017e454c07012f1a887bd3e88eb4709d34d', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'pangyoki'}, {'branch': 'develop', 'PR': '31593', 'commit_createTime': 1615540549, 'paddle_build_startTime': 1615540581, 'paddle_build_endTime': 1615540764, 'waitTime_total': 32, 'execTime_total': 183, 'EXCODE': 1, 'ciName': 'PR-CI-Windows', 'commitId': 'e39f9787acda516f7769708066e9b78b10f95c16', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'JZ-LIANG'}, {'branch': 'develop', 'PR': '31362', 'commit_createTime': 1615540074, 'paddle_build_startTime': 1615540080, 'paddle_build_endTime': 1615540125, 'waitTime_total': 6, 'execTime_total': 45, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': '5d29a27c2ef4d7398959a9e36feca42599e4ce38', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'gongweibao'}, {'branch': 'develop', 'PR': '31362', 'commit_createTime': 1615539829, 'paddle_build_startTime': 1615539914, 'paddle_build_endTime': 1615539935, 'waitTime_total': 85, 'execTime_total': 21, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': '09bf2cfc0e60d4eced80b03d21bd944204c9d9ff', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'gongweibao'}, {'branch': 'develop', 'PR': '31362', 'commit_createTime': 1615538614, 'paddle_build_startTime': 1615538617, 'paddle_build_endTime': 1615538637, 'waitTime_total': 3, 'execTime_total': 20, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': 'f1fdddfdc834637578d708e384e41d2b3b72a9d3', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'gongweibao'}, {'branch': 'develop', 'PR': '31551', 'commit_createTime': 1615537087, 'paddle_build_startTime': 1615539776, 'paddle_build_endTime': 1615539996, 'waitTime_total': 2689, 'execTime_total': 220, 'EXCODE': 7, 'ciName': 'PR-CI-Windows', 'commitId': 'a1aafbdfe6762cac886b98f3cc11b019b1fb104d', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'qili93'}, {'branch': 'develop', 'PR': '31540', 'commit_createTime': 1615534891, 'paddle_build_startTime': 1615534895, 'paddle_build_endTime': 1615537790, 'waitTime_total': 4, 'execTime_total': 2895, 'EXCODE': 1, 'ciName': 'PR-CI-Windows', 'commitId': 'ef4c7b90af5a2cd8ad0982e1a5bd7fa3a67b484b', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'MingMingShangTian'}, {'branch': 'develop', 'PR': '31588', 'commit_createTime': 1615533335, 'paddle_build_startTime': 1615533341, 'paddle_build_endTime': 1615540914, 'waitTime_total': 6, 'execTime_total': 7573, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '0efa56aff976c2eb6e729514825b245b73a8faf7', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'chenwhql'}, {'branch': 'develop', 'PR': '31587', 'commit_createTime': 1615532832, 'paddle_build_startTime': 1615534476, 'paddle_build_endTime': 1615542518, 'waitTime_total': 1644, 'execTime_total': 8042, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': 'ff247dc718a4a3534e8f5fcc22227b0bb4ad8ff2', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'shangzhizhou'}, {'branch': 'develop', 'PR': '31377', 'commit_createTime': 1615527918, 'paddle_build_startTime': 1615527924, 'paddle_build_endTime': 1615533499, 'waitTime_total': 6, 'execTime_total': 5575, 'EXCODE': 8, 'ciName': 'PR-CI-Windows', 'commitId': 'be38aa48653bada15437cd551150ae86020ab033', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'zhouwei25'}, {'branch': 'develop', 'PR': '31498', 'commit_createTime': 1615526245, 'paddle_build_startTime': 1615526252, 'paddle_build_endTime': 1615528663, 'waitTime_total': 7, 'execTime_total': 2411, 'EXCODE': 1, 'ciName': 'PR-CI-Windows', 'commitId': '664be5818dd318cd8106004a8f7d58a150e6967f', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'XieYunshen'}, {'branch': 'develop', 'PR': '31572', 'commit_createTime': 1615519019, 'paddle_build_startTime': 1615519022, 'paddle_build_endTime': 1615519045, 'waitTime_total': 3, 'execTime_total': 23, 'EXCODE': 1, 'ciName': 'PR-CI-Windows', 'commitId': '30a57689f589e4d81b639ef67cca8dd906a1bc93', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'TCChenlong'}, {'branch': 'develop', 'PR': '31569', 'commit_createTime': 1615517845, 'paddle_build_startTime': 1615519051, 'paddle_build_endTime': 1615519063, 'waitTime_total': 1206, 'execTime_total': 12, 'EXCODE': 2, 'ciName': 'PR-CI-Windows', 'commitId': 'ab5e861c38e6c990682f88111c82a9a7fe53bcbe', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'vslyu'}, {'branch': 'develop', 'PR': '31085', 'commit_createTime': 1615468548, 'paddle_build_startTime': 1615468557, 'paddle_build_endTime': 1615474693, 'waitTime_total': 9, 'execTime_total': 6136, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '7b54b1cc52726cae44bbd8715804b67152688694', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'hbwx24'}, {'branch': 'develop', 'PR': '31553', 'commit_createTime': 1615461987, 'paddle_build_startTime': 1615463187, 'paddle_build_endTime': 1615468546, 'waitTime_total': 1200, 'execTime_total': 5359, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '95350aabd823abe8f29e03bb9ebdb3787a1d205b', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'qili93'}, {'branch': 'develop', 'PR': '31511', 'commit_createTime': 1615461682, 'paddle_build_startTime': 1615461807, 'paddle_build_endTime': 1615469156, 'waitTime_total': 125, 'execTime_total': 7349, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '5fcc12390fd3c1f2ec696313c5947428ccf801af', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'jiweibo'}, {'branch': 'develop', 'PR': '31412', 'commit_createTime': 1615461368, 'paddle_build_startTime': 1615461378, 'paddle_build_endTime': 1615469664, 'waitTime_total': 10, 'execTime_total': 8286, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': 'ad45894aff381f6a07bf81c21cf6b2bb2e1de181', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'pangyoki'}, {'branch': 'develop', 'PR': '31498', 'commit_createTime': 1615460344, 'paddle_build_startTime': 1615460350, 'paddle_build_endTime': 1615463185, 'waitTime_total': 6, 'execTime_total': 2835, 'EXCODE': 8, 'ciName': 'PR-CI-Windows', 'commitId': 'ab3de24959503cbec4b37ba77ff6ba963247bacc', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'XieYunshen'}, {'branch': 'develop', 'PR': '31556', 'commit_createTime': 1615457606, 'paddle_build_startTime': 1615458649, 'paddle_build_endTime': 1615464828, 'waitTime_total': 1043, 'execTime_total': 6179, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '204112f1ed32846819f37e44775c7627644e9f7c', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'Aurelius84'}, {'branch': 'develop', 'PR': '31377', 'commit_createTime': 1615457364, 'paddle_build_startTime': 1615457914, 'paddle_build_endTime': 1615463922, 'waitTime_total': 550, 'execTime_total': 6008, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '98af7222b8b0a6460c3b1a4a46b937cac2de5215', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'zhouwei25'}, {'branch': 'develop', 'PR': '31557', 'commit_createTime': 1615455441, 'paddle_build_startTime': 1615455445, 'paddle_build_endTime': 1615461035, 'waitTime_total': 4, 'execTime_total': 5590, 'EXCODE': 8, 'ciName': 'PR-CI-Windows', 'commitId': 'c0abddb1060c2c8018c3234effbc722ba98d8e07', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'livingbody'}, {'branch': 'develop', 'PR': '31513', 'commit_createTime': 1615454433, 'paddle_build_startTime': 1615454626, 'paddle_build_endTime': 1615461388, 'waitTime_total': 193, 'execTime_total': 6762, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '0493c80f9d62126eed462af3e2da72e130025ba1', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'cryoco'}, {'branch': 'develop', 'PR': '31535', 'commit_createTime': 1615453370, 'paddle_build_startTime': 1615454441, 'paddle_build_endTime': 1615461804, 'waitTime_total': 1071, 'execTime_total': 7363, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': '0d3b510f17161e8e2b44ceb50c53f293f4a9fb77', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'chenwhql'}, {'branch': 'develop', 'PR': '31551', 'commit_createTime': 1615448493, 'paddle_build_startTime': 1615450352, 'paddle_build_endTime': 1615450521, 'waitTime_total': 1859, 'execTime_total': 169, 'EXCODE': 7, 'ciName': 'PR-CI-Windows', 'commitId': '82378bcf60fa0595747ade1c20496ad2e2592b16', 'status': 'failure', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'qili93'}, {'branch': 'develop', 'PR': '31543', 'commit_createTime': 1615435082, 'paddle_build_startTime': 1615435418, 'paddle_build_endTime': 1615442776, 'waitTime_total': 336, 'execTime_total': 7358, 'EXCODE': 0, 'ciName': 'PR-CI-Windows', 'commitId': 'a5d38e969d1eed15d725f97fa8b1bc279394f0eb', 'status': 'success', 'repo': 'PaddlePaddle/Paddle', 'triggerUser': 'wanghaoshuang'}]
details_supplements = [{'ciName': 'PR-CI-Windows', 'commitId': '99ce420f7a772214444df35f38c8790a1aa7045a', 'EXCODE': 0, 'triggerUser': 'arlesniak', 'PR': 31093, 'createTime': 1615552982, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615559635, 'buildTime': 2494.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.5, 'testCaseTime_single': 4077, 'testCaseTime_total': 4077, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '96ebd01b02d19d419787c2e5878965c95e23ae38', 'EXCODE': 0, 'triggerUser': 'qili93', 'PR': 31551, 'createTime': 1615552795, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615559848, 'buildTime': 2772.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 4185, 'testCaseTime_total': 4185, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '2da4be5d01cf2b98fcff8524234d9145c4ff56e7', 'EXCODE': 0, 'triggerUser': 'chenwhql', 'PR': 31602, 'createTime': 1615552054, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615557657, 'buildTime': 2721.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 2800, 'testCaseTime_total': 2800, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'e2defa2af790bf520465b0d1a79fb1ab7f9e208b', 'EXCODE': 0, 'triggerUser': 'jiweibo', 'PR': 31511, 'createTime': 1615549520, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615555648, 'buildTime': 3187.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 2864, 'testCaseTime_total': 2864, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '3746d7e9bac375c69e1e2fce26be893c2cb8dde6', 'EXCODE': 0, 'triggerUser': 'XieYunshen', 'PR': 31505, 'createTime': 1615548097, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615554520, 'buildTime': 2284.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 4066, 'testCaseTime_total': 4066, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'f9d997b5f2919a545b9892d5015061003936ca48', 'EXCODE': 0, 'triggerUser': 'XieYunshen', 'PR': 31498, 'createTime': 1615547574, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615551458, 'buildTime': 2803.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 976, 'testCaseTime_total': 976, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '483b7d30649ec1cc3ba3c3c36373786e236d85a3', 'EXCODE': 0, 'triggerUser': 'gongweibao', 'PR': 31570, 'createTime': 1615543522, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615550664, 'buildTime': 2353.0, 'fluidInferenceSize': 231.0, 'WhlSize': 118.7, 'testCaseTime_single': 4669, 'testCaseTime_total': 4669, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '3f01c5cb81cf8bb99c1f3cd6270060fe248a316c', 'EXCODE': 0, 'triggerUser': 'JZ-LIANG', 'PR': 31593, 'createTime': 1615542116, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615548487, 'buildTime': 2430.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.5, 'testCaseTime_single': 3721, 'testCaseTime_total': 3721, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '8c279017e454c07012f1a887bd3e88eb4709d34d', 'EXCODE': 1, 'triggerUser': 'pangyoki', 'PR': 31594, 'createTime': 1615540859, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615541055}, {'ciName': 'PR-CI-Windows', 'commitId': 'e39f9787acda516f7769708066e9b78b10f95c16', 'EXCODE': 1, 'triggerUser': 'JZ-LIANG', 'PR': 31593, 'createTime': 1615540549, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615540764}, {'ciName': 'PR-CI-Windows', 'commitId': 'c34b76bdc9ee14e0b56a1b3a41f0eb381ac2dd44', 'EXCODE': 8, 'triggerUser': 'XieYunshen', 'PR': 31498, 'createTime': 1615536303, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615541672, 'buildTime': 2944.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 15, 'testCaseTime_total': 15, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'ef4c7b90af5a2cd8ad0982e1a5bd7fa3a67b484b', 'EXCODE': 1, 'triggerUser': 'MingMingShangTian', 'PR': 31540, 'createTime': 1615534891, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615537790}, {'ciName': 'PR-CI-Windows', 'commitId': '0efa56aff976c2eb6e729514825b245b73a8faf7', 'EXCODE': 0, 'triggerUser': 'chenwhql', 'PR': 31588, 'createTime': 1615533335, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615540914, 'buildTime': 2430.0, 'fluidInferenceSize': 231.0, 'WhlSize': 118.7, 'testCaseTime_single': 5010, 'testCaseTime_total': 5010, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'ff247dc718a4a3534e8f5fcc22227b0bb4ad8ff2', 'EXCODE': 0, 'triggerUser': 'shangzhizhou', 'PR': 31587, 'createTime': 1615532832, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615542518, 'buildTime': 3033.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 4920, 'testCaseTime_total': 4920, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'be38aa48653bada15437cd551150ae86020ab033', 'EXCODE': 8, 'triggerUser': 'zhouwei25', 'PR': 31377, 'createTime': 1615527918, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615533499, 'buildTime': 2196.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 3307, 'testCaseTime_total': 3307, 'buildCache': 1}, {'ciName': 'PR-CI-Windows', 'commitId': '664be5818dd318cd8106004a8f7d58a150e6967f', 'EXCODE': 1, 'triggerUser': 'XieYunshen', 'PR': 31498, 'createTime': 1615526245, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615528663}, {'ciName': 'PR-CI-Windows', 'commitId': 'a568244b3e8f17fb50564ddb2e7300aa2f789ed7', 'EXCODE': 8, 'triggerUser': 'XieYunshen', 'PR': 31498, 'createTime': 1615520162, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615523424, 'buildTime': 3167.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 13, 'testCaseTime_total': 13, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '30a57689f589e4d81b639ef67cca8dd906a1bc93', 'EXCODE': 1, 'triggerUser': 'TCChenlong', 'PR': 31572, 'createTime': 1615519019, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615519045}, {'ciName': 'PR-CI-Windows', 'commitId': '7b54b1cc52726cae44bbd8715804b67152688694', 'EXCODE': 0, 'triggerUser': 'hbwx24', 'PR': 31085, 'createTime': 1615468548, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615474693, 'buildTime': 2352.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 3689, 'testCaseTime_total': 3689, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '95350aabd823abe8f29e03bb9ebdb3787a1d205b', 'EXCODE': 0, 'triggerUser': 'qili93', 'PR': 31553, 'createTime': 1615461987, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615468546, 'buildTime': 2678.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 2616, 'testCaseTime_total': 2616, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '5fcc12390fd3c1f2ec696313c5947428ccf801af', 'EXCODE': 0, 'triggerUser': 'jiweibo', 'PR': 31511, 'createTime': 1615461682, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615469156, 'buildTime': 2312.0, 'fluidInferenceSize': 232.0, 'WhlSize': 118.3, 'testCaseTime_single': 4930, 'testCaseTime_total': 4930, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'ad45894aff381f6a07bf81c21cf6b2bb2e1de181', 'EXCODE': 0, 'triggerUser': 'pangyoki', 'PR': 31412, 'createTime': 1615461368, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615469664, 'buildTime': 3083.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 5132, 'testCaseTime_total': 5132, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'ab3de24959503cbec4b37ba77ff6ba963247bacc', 'EXCODE': 8, 'triggerUser': 'XieYunshen', 'PR': 31498, 'createTime': 1615460344, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615463185, 'buildTime': 2760.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 15, 'testCaseTime_total': 15, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '204112f1ed32846819f37e44775c7627644e9f7c', 'EXCODE': 0, 'triggerUser': 'Aurelius84', 'PR': 31556, 'createTime': 1615457606, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615464828, 'buildTime': 2202.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 3908, 'testCaseTime_total': 3908, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '98af7222b8b0a6460c3b1a4a46b937cac2de5215', 'EXCODE': 0, 'triggerUser': 'zhouwei25', 'PR': 31377, 'createTime': 1615457364, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615463922, 'buildTime': 2383.0, 'fluidInferenceSize': 231.0, 'WhlSize': 118.7, 'testCaseTime_single': 3533, 'testCaseTime_total': 3533, 'buildCache': 1}, {'ciName': 'PR-CI-Windows', 'commitId': 'c0abddb1060c2c8018c3234effbc722ba98d8e07', 'EXCODE': 8, 'triggerUser': 'livingbody', 'PR': 31557, 'createTime': 1615455441, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615461035, 'buildTime': 2596.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 2692, 'testCaseTime_total': 2692, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '0493c80f9d62126eed462af3e2da72e130025ba1', 'EXCODE': 0, 'triggerUser': 'cryoco', 'PR': 31513, 'createTime': 1615454433, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615461388, 'buildTime': 2876.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 3802, 'testCaseTime_total': 3802, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': '0d3b510f17161e8e2b44ceb50c53f293f4a9fb77', 'EXCODE': 0, 'triggerUser': 'chenwhql', 'PR': 31535, 'createTime': 1615453370, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615461804, 'buildTime': 2340.0, 'fluidInferenceSize': 232.0, 'WhlSize': 118.3, 'testCaseTime_single': 4921, 'testCaseTime_total': 4921, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'f421380ff5a1af4c88a0db45f45a4b6448e4c74c', 'EXCODE': 0, 'triggerUser': 'zhouwei', 'PR': 31549, 'createTime': 1615452307, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615458648, 'buildTime': 2042.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 4203, 'testCaseTime_total': 4203, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'cc4b3ab1f2b004d1108271569b6dae627049b89e', 'EXCODE': 0, 'triggerUser': 'paddle_dev', 'PR': 31546, 'createTime': 1615447948, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615454623, 'buildTime': 2715.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 3847, 'testCaseTime_total': 3847, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'bbee42aeecd8f7047612fdabb51118a0f8f83342', 'EXCODE': 0, 'triggerUser': 'paddle_dev', 'PR': 31539, 'createTime': 1615446539, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615451476, 'buildTime': 2313.0, 'fluidInferenceSize': 232.0, 'WhlSize': 126.4, 'testCaseTime_single': 2553, 'testCaseTime_total': 2553, 'buildCache': 0}, {'ciName': 'PR-CI-Windows', 'commitId': 'fb5eeabda0713b1fd6949b54daaea6040e43912a', 'EXCODE': 8, 'triggerUser': 'zhouwei25', 'PR': 31377, 'createTime': 1615444070, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615451032, 'buildTime': 2385.0, 'fluidInferenceSize': 238.0, 'WhlSize': 120.4, 'testCaseTime_single': 4490, 'testCaseTime_total': 4490, 'buildCache': 1}, {'ciName': 'PR-CI-Windows', 'commitId': 'a5d38e969d1eed15d725f97fa8b1bc279394f0eb', 'EXCODE': 0, 'triggerUser': 'wanghaoshuang', 'PR': 31543, 'createTime': 1615435082, 'branch': 'develop', 'repo': 'PaddlePaddle/Paddle', 'endTime': 1615442776, 'buildTime': 2355.0, 'fluidInferenceSize': 232.0, 'WhlSize': 118.3, 'testCaseTime_single': 4900, 'testCaseTime_total': 4900, 'buildCache': 0}]







for i in basic_supplements:#details_supplements:
    print(i)
    result = db.insert('paddle_ci_status', i)
    print(result)

print('detail: ')
for i in details_supplements:
    if 'buildTime' in i:
        #print(i)
        result = db.insert('paddle_ci_index', i)
        print(result)
    else:
        print("xxxxx:   %s" %i)
